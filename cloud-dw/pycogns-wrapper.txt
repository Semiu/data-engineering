import configparser
import psycopg2
config = configparser.ConfigParser()
config.read('dwh.cfg')
conn = psycopg2.connect("host={} dbname={} user={} password={} port={}".format(*config['CLUSTER'].values()))
cur = conn.cursor()
sql = """select * from stl_load_errors"""
cur.execute(sql)

row = cur.fetchone()
while row:
    print(row)
    row = cur.fetchone()



conn.close()
quit()


File "C:\Users\Admin\Documents\data-engineering\cloud-dw\redshift-etl-project\etl.py", line 22, in insert_tables
psycopg2.errors.DatatypeMismatch: column "user_id" is of type integer but expression is of type text
HINT:  You will need to rewrite or cast the expression.
